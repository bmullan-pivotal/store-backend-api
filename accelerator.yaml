accelerator:
  displayName: Backend API for online-stores
  description: Accelerator to create Backend API service for online stores
  iconUrl: https://raw.githubusercontent.com/simple-starters/icons/master/icon-boot.png
  tags:
  - onlinestore-dev

  options:
  - name: firstApiGroup
    label: First level API group
    description: Name of the first level API group
    defaultValue: apiGroup1
    required: true
  - name: secondApiGroup
    label: Second level API group
    description: Name of the second API group
    defaultValue: apiGroup2
    display: true
  - name: thirdApiGroup
    label: Third  level API group
    description: Name of the third API group
    defaultValue: apiGroup3
  - name: forthApiGroup
    label: Forth level API group
    description: Name of the forth API group
    defaultValue: apiGroup4
  - name: fifthApiGroup
    label: Fifth level API group
    description: Name of the Fifth API group
    defaultValue: apiGroup5

  - name: addDataService
    label: Add a data service entity bean
    description: Add a data service entity bean class to the generated code
    inputType: toggle
    display: true
    dataType: boolean
    defaultValue: false

  - name: entityType
    label: Data service entity type
    description: Select the data service type
    dependsOn:
      name: addDataService
    inputType: select
    choices:
      - value: mySQL
        text: MySQL
      - value: mariaDB
        text: MariaDB
      - value: postgreSQL
        text: PostgreSQL
      - value: db2
        text: DB2
      - value: redis
        text: Redis
    
  - name: entityName
    label: Data service entity name
    description: Data service entity name
    dependsOn:
      name: addDataService

  
  - name: appDeploymentType
    label: App deployment config
    description: Type of deployment configurations
    required: true
    defaultValue: k8s
    inputType: select
    choices:
      - value: k8s
        text: K8s simple
      - value: k8sObserver
        text: K8s with Boot Observer sidecar
      - value: k8sSkaffold
        text: K8s with Skaffold configs
      - value: cf
        text: Cloud Foundry manifest

  - name: apiSamples
    inputType: checkbox
    label: API samples
    description: API developement samples
    display: true
    dataType: [string]
    defaultValue:
      - k8s
    choices:
      - value: k8s  
        text: routes and gateway definitions for k8s
      - value: cf
        text: routes and gateway definitions for Cloud Foundry

engine:
  merge:
    #generic transformation
    - includes: ["**"]
      excludes: [ "accelerators/**" ]
      chain:
        - type: ReplaceText
          substitutions:
            - text: app-name
              with: "#artifactId"
            - text: entityName
              with: "#entityName"
  #deployment transformations
    - includes: [ "accelerators/deployment/app-simple.yaml" ]
      condition: "#appDeploymentType == 'k8s'"
      chain:
        - type: ReplaceText
          substitutions:
            - text: app-name
              with: "#artifactId"
    - includes: [ "accelerators/deployment/app-observer.yaml" ]
      condition: "#appDeploymentType == 'k8sObserver'"
      chain:
        - type: ReplaceText
          substitutions:
            - text: app-name
              with: "#artifactId"
    - includes: [ "accelerators/deployment/app-simple.yaml", "accelerators/deployment/skaffold.yaml"]
      condition: "#appDeploymentType == 'k8sSkaffold'"
      chain:
        - type: ReplaceText
          substitutions:
            - text: app-name
              with: "#artifactId"
    #api-grid transformations
    - includes: [ "accelerators/api-grid/k8s/**" ]
      condition: "#apiSamples.contains('k8s')"
      chain:
        - type: ReplaceText
          substitutions:
            - text: app-name
              with: "#artifactId"
            - text: api-group1
              with: "#firstApiGroup"
            - text: api-group2
              with: "#secondApiGroup"
    - includes: [ "accelerators/api-grid/cf/**" ]
      condition: "#apiSamples.contains('cf')"
      chain:
        - type: ReplaceText
          substitutions:
          - text: app-name
            with: "#artifactId"
          - text: api-group1
            with: "#firstApiGroup"
          - text: api-group2
            with: "#secondApiGroup"
